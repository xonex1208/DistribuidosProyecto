#include <OLED_I2C.h>
#define MAXBALAS 3//Maximo numero de balas al mismo tiempo
#define VELBALAS 5//Velocidad delas valas
#define RECARGA 3//Tiempo que toma la nave para lanzar la siguiente bala
#define MAXENEMIGOS 5//Maximo numero de enemigos al mismo tiempo
#define VELENEMIGOS 1//Velocidad de los enemigos
#define SEPENEMIGOS 20//Tiempo que pasa entre la generacion de un nuevo enemigo
//tipos de sprites
#define PLAYER 1//Jugador
#define ENEMIGO 2//Enemigo
#define BALA 3//balla
//Pines
#define BOTON 17
#define EJEX 16
#define EJEY 15


OLED  myOLED(SDA, SCL);//Se instancia la clase OLED que controla la pantalla

extern const uint8_t TinyFont[];//Fuente para escribir texto y numeros

const uint8_t foto[] PROGMEM={//128x64
0x55, 0x22, 0x55, 0xEF, 0x55, 0xAA, 0x55, 0xFF, 0x57, 0xBF, 0x55, 0xFF, 0x55, 0xBA, 0xFF, 0xFF,   // 0x0010 (16) pixels
0xFF, 0xFF, 0xFF, 0xFF, 0x77, 0xFF, 0x55, 0xFF, 0x55, 0xBB, 0x55, 0xEF, 0x55, 0xBB, 0x55, 0xFE,   // 0x0020 (32) pixels
0x55, 0xBB, 0x55, 0xEE, 0x55, 0xBB, 0x55, 0x3E, 0x15, 0x0B, 0x15, 0x0F, 0x15, 0x03, 0x05, 0x0F,   // 0x0030 (48) pixels
0x15, 0x03, 0x05, 0x07, 0x15, 0x03, 0x05, 0x0F, 0x15, 0x1F, 0x15, 0x3F, 0x55, 0xBB, 0x55, 0xFF,   // 0x0040 (64) pixels
0x55, 0xBF, 0x55, 0xFF, 0x55, 0xBB, 0x55, 0xFF, 0x55, 0xBF, 0x55, 0xFF, 0x55, 0xFF, 0x55, 0xFF,   // 0x0050 (80) pixels
0x55, 0xFF, 0x55, 0xFF, 0x55, 0x3F, 0x55, 0x0F, 0x15, 0x0F, 0x05, 0x0F, 0x15, 0x0F, 0x05, 0x0F,   // 0x0060 (96) pixels
0x15, 0x0F, 0x05, 0x0F, 0x15, 0x0F, 0x15, 0x0F, 0x15, 0x3F, 0x55, 0x3F, 0x55, 0xFB, 0x55, 0xFF,   // 0x0070 (112) pixels
0x55, 0xBF, 0x55, 0xFF, 0x55, 0xFB, 0x55, 0xFF, 0x55, 0xBF, 0x55, 0xFF, 0x55, 0xFB, 0x55, 0xFF,   // 0x0080 (128) pixels
0x57, 0x2A, 0x55, 0xAF, 0x55, 0xFB, 0x55, 0xFF, 0x55, 0xFF, 0x55, 0xFF, 0x55, 0xFF, 0xFF, 0xFF,   // 0x0090 (144) pixels
0xFF, 0xFF, 0xFF, 0xFF, 0x77, 0xFF, 0xD5, 0xFF, 0x55, 0xFF, 0x55, 0xFF, 0x55, 0xFB, 0x55, 0xFF,   // 0x00A0 (160) pixels
0x55, 0xBB, 0x55, 0x0F, 0x15, 0x02, 0x40, 0x00, 0x51, 0x20, 0x54, 0x88, 0x51, 0xA0, 0x54, 0xA0,   // 0x00B0 (176) pixels
0x51, 0xA0, 0x55, 0xC0, 0x51, 0xA0, 0x44, 0x80, 0x11, 0x00, 0x45, 0x00, 0x11, 0x00, 0x45, 0x0F,   // 0x00C0 (192) pixels
0x15, 0x3F, 0x55, 0xEF, 0x55, 0xBB, 0x55, 0xFF, 0x55, 0xBF, 0x55, 0xFF, 0x55, 0xBB, 0x55, 0x03,   // 0x00D0 (208) pixels
0x15, 0x03, 0x01, 0x00, 0x11, 0x00, 0x40, 0x00, 0x11, 0x00, 0x40, 0x00, 0x51, 0x20, 0x50, 0xA0,   // 0x00E0 (224) pixels
0x51, 0xA0, 0x54, 0xA8, 0x50, 0xA0, 0x50, 0xE0, 0x51, 0xA0, 0x45, 0x80, 0x11, 0x00, 0x05, 0x03,   // 0x00F0 (240) pixels
0x15, 0x2F, 0x55, 0xFF, 0x55, 0xBF, 0x55, 0xFF, 0x55, 0xBF, 0x55, 0xFF, 0x55, 0xFB, 0x55, 0xFF,   // 0x0100 (256) pixels
0x57, 0x2A, 0x55, 0xFF, 0x55, 0xBF, 0x55, 0xFF, 0x55, 0xFF, 0x5D, 0xFF, 0x55, 0xFF, 0xFF, 0xFF,   // 0x0110 (272) pixels
0xFF, 0xFF, 0xFF, 0xFF, 0x77, 0xFF, 0xDD, 0xFF, 0x57, 0xFF, 0x55, 0xFF, 0x55, 0xFB, 0x55, 0xFF,   // 0x0120 (288) pixels
0x55, 0x00, 0x54, 0x00, 0x15, 0x00, 0x45, 0x88, 0x15, 0x2A, 0x55, 0x2A, 0x55, 0xBB, 0x55, 0xFE,   // 0x0130 (304) pixels
0x55, 0xBF, 0x55, 0xFF, 0x75, 0xFF, 0x55, 0xFE, 0x55, 0xBA, 0x55, 0x00, 0x51, 0x00, 0x00, 0x00,   // 0x0140 (320) pixels
0x41, 0x82, 0x55, 0xEF, 0x55, 0xBB, 0x55, 0xFF, 0x55, 0xBB, 0x55, 0xA3, 0x11, 0x01, 0x01, 0x00,   // 0x0150 (336) pixels
0x01, 0x00, 0x44, 0x00, 0x11, 0x00, 0x55, 0x00, 0x15, 0x02, 0x55, 0x8A, 0x55, 0xA2, 0x55, 0xEA,   // 0x0160 (352) pixels
0x55, 0xBB, 0x55, 0xEE, 0x55, 0xFB, 0x55, 0xFF, 0x57, 0x3F, 0x55, 0xBF, 0x75, 0xF8, 0x54, 0x80,   // 0x0170 (368) pixels
0x11, 0x02, 0x55, 0xBF, 0x55, 0xBB, 0x55, 0xFF, 0x55, 0xBB, 0x55, 0xFF, 0x55, 0xBB, 0x55, 0xFF,   // 0x0180 (384) pixels
0x55, 0x22, 0x55, 0x0F, 0x55, 0x23, 0x55, 0x8F, 0x55, 0x2B, 0x55, 0xAE, 0xFF, 0xFF, 0xFF, 0xFF,   // 0x0190 (400) pixels
0x7F, 0xBF, 0x5F, 0xFF, 0x57, 0xBF, 0x55, 0xFF, 0x57, 0xBF, 0x55, 0xAF, 0x55, 0xBB, 0x55, 0x03,   // 0x01A0 (416) pixels
0x55, 0x20, 0x55, 0xA0, 0x51, 0x22, 0x55, 0x08, 0x15, 0x00, 0x55, 0xE8, 0x75, 0xBB, 0x55, 0xE8,   // 0x01B0 (432) pixels
0x55, 0x23, 0x55, 0x8B, 0x51, 0x33, 0x55, 0xAF, 0x55, 0x2B, 0x55, 0x00, 0x11, 0x80, 0x54, 0xFE,   // 0x01C0 (448) pixels
0x55, 0xBB, 0x55, 0xEF, 0x55, 0xBB, 0x55, 0xFF, 0x55, 0xBB, 0x55, 0xAF, 0x11, 0x00, 0x00, 0x00,   // 0x01D0 (464) pixels
0x11, 0x00, 0x45, 0x00, 0x11, 0x00, 0x54, 0x08, 0x15, 0x08, 0x55, 0x00, 0x11, 0x00, 0x45, 0x02,   // 0x01E0 (480) pixels
0x15, 0xBF, 0x5D, 0xFE, 0x55, 0xAA, 0x55, 0x82, 0x55, 0x82, 0x55, 0xEF, 0x57, 0xFF, 0x5D, 0xFE,   // 0x01F0 (496) pixels
0x55, 0x00, 0x45, 0xAF, 0x55, 0xBB, 0x55, 0xEF, 0x55, 0xBB, 0x55, 0xEF, 0x55, 0xBB, 0x55, 0xFF,   // 0x0200 (512) pixels
0x55, 0x22, 0x55, 0x08, 0x55, 0x22, 0x55, 0x88, 0x55, 0x22, 0x55, 0xFE, 0xFF, 0xFF, 0x55, 0xFF,   // 0x0210 (528) pixels
0x55, 0xBB, 0x55, 0xAE, 0x55, 0xBB, 0x55, 0xAA, 0x55, 0xBB, 0x55, 0x2E, 0x55, 0x03, 0x55, 0x00,   // 0x0220 (544) pixels
0x15, 0x02, 0x15, 0x02, 0x15, 0x00, 0x45, 0xC0, 0x55, 0xAA, 0x55, 0xEF, 0x55, 0xFB, 0x55, 0xFF,   // 0x0230 (560) pixels
0x57, 0xFE, 0x55, 0xFE, 0x55, 0xBF, 0x55, 0x0A, 0x15, 0x82, 0x45, 0xA0, 0x55, 0xBA, 0x55, 0xEE,   // 0x0240 (576) pixels
0x55, 0xBB, 0x55, 0xEE, 0x55, 0xBB, 0x55, 0xEE, 0x55, 0xBB, 0x55, 0xFF, 0x55, 0x00, 0x50, 0x00,   // 0x0250 (592) pixels
0x15, 0x00, 0x44, 0x00, 0x11, 0x00, 0x55, 0x00, 0x55, 0x20, 0x55, 0x00, 0x11, 0x00, 0x54, 0x00,   // 0x0260 (608) pixels
0x11, 0x02, 0x55, 0xFF, 0x77, 0xBF, 0x55, 0xFE, 0x55, 0x9B, 0x55, 0x3F, 0x55, 0xFB, 0x55, 0xFF,   // 0x0270 (624) pixels
0x77, 0xFE, 0x55, 0xEF, 0x55, 0xBB, 0x55, 0xFE, 0x55, 0xBB, 0x55, 0xEF, 0x55, 0xBB, 0x55, 0xFF,   // 0x0280 (640) pixels
0x55, 0x22, 0x55, 0x88, 0x55, 0xA2, 0x55, 0xE0, 0x55, 0xAA, 0x55, 0xAF, 0x57, 0xBB, 0x55, 0xAB,   // 0x0290 (656) pixels
0x55, 0xAB, 0x55, 0xAA, 0x55, 0x22, 0x55, 0xAA, 0x55, 0x22, 0x55, 0x00, 0x11, 0x00, 0x40, 0x00,   // 0x02A0 (672) pixels
0x11, 0x00, 0x55, 0x00, 0x51, 0x22, 0x54, 0xE0, 0x55, 0xAA, 0x55, 0xAA, 0x51, 0xA2, 0x55, 0x2B,   // 0x02B0 (688) pixels
0x55, 0x3B, 0x15, 0x0F, 0x55, 0xA2, 0x55, 0xEE, 0x55, 0xBB, 0x55, 0xAE, 0x55, 0xBB, 0x55, 0xAE,   // 0x02C0 (704) pixels
0x55, 0xBB, 0x55, 0xAF, 0x55, 0xBB, 0x55, 0xEE, 0x55, 0xBB, 0x55, 0xAF, 0x55, 0xBA, 0x54, 0xF8,   // 0x02D0 (720) pixels
0x51, 0xE0, 0x45, 0x00, 0x11, 0x00, 0x55, 0x02, 0x51, 0x00, 0x45, 0x00, 0x11, 0x00, 0x44, 0x00,   // 0x02E0 (736) pixels
0x55, 0x22, 0x55, 0xAF, 0x55, 0xAF, 0x55, 0xEF, 0x57, 0xEF, 0x55, 0xEE, 0x55, 0xF8, 0x55, 0xFF,   // 0x02F0 (752) pixels
0x75, 0xBF, 0x55, 0xEF, 0x55, 0xBB, 0x55, 0xFE, 0x55, 0xBB, 0x55, 0xEF, 0x55, 0xBB, 0x55, 0xEE,   // 0x0300 (768) pixels
0x55, 0xAA, 0x55, 0xEE, 0x75, 0xFF, 0x55, 0xFF, 0x75, 0xFF, 0xD5, 0xEE, 0x55, 0xBA, 0x55, 0xEA,   // 0x0310 (784) pixels
0x55, 0xAB, 0x55, 0xAA, 0x55, 0xA2, 0x55, 0xA8, 0x55, 0x22, 0x55, 0x80, 0x51, 0x00, 0x40, 0x00,   // 0x0320 (800) pixels
0x11, 0x00, 0x05, 0x00, 0x11, 0x00, 0x45, 0x00, 0x11, 0x02, 0x45, 0x00, 0x51, 0x00, 0x40, 0x80,   // 0x0330 (816) pixels
0x51, 0x00, 0x55, 0x80, 0x55, 0xA0, 0x55, 0xAA, 0x55, 0x3B, 0x55, 0xAE, 0x55, 0xBB, 0x55, 0xAA,   // 0x0340 (832) pixels
0x55, 0xBB, 0x55, 0xAE, 0x55, 0xBB, 0x55, 0xAA, 0x55, 0xBB, 0x55, 0xAE, 0x55, 0xBB, 0x55, 0xEE,   // 0x0350 (848) pixels
0x55, 0xBB, 0x55, 0xFE, 0x51, 0x00, 0x44, 0x00, 0x11, 0x00, 0x05, 0x00, 0x11, 0x00, 0x55, 0x00,   // 0x0360 (864) pixels
0x55, 0x2B, 0x55, 0xAA, 0x55, 0xFB, 0x55, 0xFF, 0x77, 0xFF, 0x55, 0xFF, 0x55, 0xFB, 0x55, 0xFF,   // 0x0370 (880) pixels
0x55, 0xBB, 0x55, 0xEE, 0x55, 0xBB, 0x55, 0xEE, 0x55, 0xBB, 0x55, 0xEF, 0x55, 0xBB, 0x55, 0xFE,   // 0x0380 (896) pixels
0x55, 0x2A, 0x55, 0xCE, 0x57, 0xFF, 0x55, 0xFF, 0x77, 0xFF, 0x5F, 0xFF, 0x77, 0xFF, 0xFD, 0xFF,   // 0x0390 (912) pixels
0x77, 0xFF, 0x5D, 0xFF, 0x75, 0xFF, 0x55, 0xFE, 0x75, 0xFF, 0xFD, 0xFB, 0x75, 0xFE, 0x55, 0xFE,   // 0x03A0 (928) pixels
0x55, 0xBA, 0x55, 0xEA, 0x75, 0xFA, 0x75, 0xFA, 0x75, 0xFA, 0x55, 0xFA, 0x55, 0xBA, 0x55, 0xEE,   // 0x03B0 (944) pixels
0x55, 0x3A, 0x55, 0xAA, 0x55, 0x2A, 0x55, 0xAA, 0x55, 0x2A, 0x55, 0x2A, 0x55, 0x23, 0x15, 0x2A,   // 0x03C0 (960) pixels
0x15, 0x3B, 0x15, 0x2E, 0x15, 0x3B, 0x15, 0x2A, 0x15, 0x3B, 0x15, 0x0A, 0x15, 0x0B, 0x05, 0x02,   // 0x03D0 (976) pixels
0x01, 0x03, 0x41, 0x00, 0x01, 0x00, 0x04, 0x00, 0x11, 0x00, 0x44, 0x00, 0x51, 0x00, 0x40, 0x80,   // 0x03E0 (992) pixels
0x51, 0x20, 0x55, 0xAA, 0x55, 0xBB, 0x55, 0xAE, 0x55, 0xBB, 0x55, 0xFF, 0x55, 0x3F, 0x55, 0x3F,   // 0x03F0 (1008) pixels
0x15, 0x0A, 0x05, 0x00, 0x11, 0x01, 0x45, 0x02, 0x15, 0x03, 0x05, 0x03, 0x15, 0x03, 0x05, 0x0E,   // 0x0400 (1024) pixels
};

const uint8_t acerca[] PROGMEM = {//128x64
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0010 (16) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0020 (32) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0030 (48) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0040 (64) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0050 (80) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0060 (96) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0070 (112) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0080 (128) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0090 (144) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x00A0 (160) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x00B0 (176) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x00C0 (192) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x00D0 (208) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x00E0 (224) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x00F0 (240) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0100 (256) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x10, 0x10,   // 0x0110 (272) pixels
  0x10, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0xFE, 0xFE, 0xFE, 0xFE, 0x92, 0x92, 0x92, 0x82,   // 0x0120 (288) pixels
  0x82, 0x82, 0x00, 0xFE, 0xFE, 0xFE, 0xFE, 0x82, 0x82, 0xE6, 0xE6, 0xE6, 0xE6, 0x00, 0xFE, 0xFE,   // 0x0130 (304) pixels
  0xFE, 0xFE, 0x10, 0x10, 0xFE, 0xFE, 0xFE, 0xFE, 0xFE, 0x00, 0xFE, 0xFE, 0xFE, 0xFE, 0x82, 0x82,   // 0x0140 (320) pixels
  0x82, 0xFE, 0xFE, 0xFE, 0xFE, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFE, 0xFE, 0xFE,   // 0x0150 (336) pixels
  0xFE, 0x12, 0x12, 0x1E, 0x1E, 0x1E, 0x1E, 0x00, 0xFE, 0xFE, 0xFE, 0xFE, 0x82, 0x82, 0x82, 0xFE,   // 0x0160 (352) pixels
  0xFE, 0xFE, 0xFE, 0x00, 0xFE, 0xFE, 0xFE, 0xFE, 0x72, 0xF2, 0xFE, 0xFE, 0xDE, 0x9E, 0x00, 0xC6,   // 0x0170 (368) pixels
  0xC6, 0xC6, 0xC6, 0xC6, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0180 (384) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0190 (400) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x01A0 (416) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x01B0 (432) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x01C0 (448) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x01D0 (464) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x01E0 (480) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x01F0 (496) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0200 (512) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0210 (528) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0220 (544) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0xFE, 0xFE, 0xFE, 0xFE, 0xFE, 0x02, 0x02, 0xCE, 0xCE, 0xCE, 0xCE,   // 0x0230 (560) pixels
  0xCC, 0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x80, 0x00, 0xFE, 0xFE, 0xFE, 0xFE, 0xFE, 0xFC, 0xF8,   // 0x0240 (576) pixels
  0xF0, 0xF8, 0xFE, 0xFE, 0xFE, 0xFE, 0xFE, 0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x80, 0x00, 0xFE,   // 0x0250 (592) pixels
  0xFE, 0xFE, 0xFE, 0xFE, 0x02, 0x02, 0x86, 0xFE, 0xFE, 0xFE, 0xFC, 0x78, 0x00, 0x00, 0x80, 0x80,   // 0x0260 (608) pixels
  0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0270 (624) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0280 (640) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0290 (656) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x02A0 (672) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01,   // 0x02B0 (688) pixels
  0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00,   // 0x02C0 (704) pixels
  0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x01,   // 0x02D0 (720) pixels
  0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01,   // 0x02E0 (736) pixels
  0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x02F0 (752) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0300 (768) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0310 (784) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0320 (800) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0330 (816) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0340 (832) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0350 (848) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0360 (864) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0370 (880) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0380 (896) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0390 (912) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x03A0 (928) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x03B0 (944) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x03C0 (960) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x03D0 (976) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x03E0 (992) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x03F0 (1008) pixels
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // 0x0400 (1024) pixels
};

const uint8_t portada[] PROGMEM={//128x64
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x50, 0x00,
    0x10, 0x20, 0x50, 0x20, 0x70, 0x60, 0x50, 0xb0, 0x50, 0x30, 0x50, 0x20, 0x70, 0x20, 0x50, 0x40,
    0x51, 0xa0, 0x44, 0x00, 0x51, 0x00, 0x45, 0x80, 0x15, 0x03, 0x55, 0x0e, 0x15, 0x22, 0x55, 0x0a,
    0x14, 0x3c, 0x54, 0x08, 0x50, 0x10, 0x50, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x01, 0x00, 0x45, 0x00, 0x11, 0x00, 0x45, 0x00, 0x15, 0x02, 0x05, 0x02, 0x15, 0x00, 0x45, 0x00,
    0x11, 0x02, 0x55, 0x03, 0x15, 0xfa, 0x55, 0x02, 0x11, 0x00, 0x45, 0x02, 0x55, 0x20, 0x54, 0x80,
    0x15, 0x02, 0x55, 0x08, 0x55, 0x3e, 0x55, 0x80, 0x50, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00,
    0x10, 0x00, 0x40, 0x00, 0x10, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x10, 0x00, 0x10, 0x00,
    0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x44, 0x00, 0x10, 0x00, 0x44, 0x00, 0x01, 0x00, 0x04, 0x00, 0x11, 0x00, 0x45, 0x00,
    0x51, 0x00, 0x45, 0x80, 0x11, 0x23, 0x55, 0x00, 0x11, 0x00, 0x45, 0x00, 0x11, 0x00, 0x55, 0x20,
    0x55, 0x82, 0x55, 0x80, 0x55, 0x00, 0x55, 0x80, 0x55, 0xa0, 0x50, 0x80, 0x40, 0x00, 0x40, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x01, 0x00, 0x05, 0x00, 0x10, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00,
    0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x10, 0x00, 0x04, 0x00, 0x51, 0x02, 0x54, 0x20, 0x10, 0x00, 0x00, 0x00, 0x51, 0x20, 0x44, 0x18,
    0x15, 0x00, 0x05, 0x00, 0x51, 0x20, 0x54, 0x00, 0x11, 0x00, 0x04, 0x00, 0x11, 0x00, 0x50, 0x00,
    0x11, 0x01, 0x05, 0x01, 0x11, 0x03, 0x45, 0x02, 0x15, 0x02, 0x05, 0x02, 0x15, 0x00, 0x00, 0x00,
    0x15, 0x03, 0x05, 0x0e, 0x15, 0x3e, 0x5d, 0xbe, 0x75, 0xa3, 0x55, 0x00, 0x55, 0xa0, 0x50, 0x80,
    0x15, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x10, 0x00, 0x04, 0x00, 0x10, 0x00, 0x50, 0x00,
    0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x80, 0x40, 0x00, 0x41, 0x80,
    0x41, 0x00, 0x40, 0x80, 0x41, 0x00, 0x40, 0x00, 0x41, 0x00, 0x01, 0x00, 0x15, 0x00, 0x44, 0x08,
    0x15, 0x00, 0x54, 0x00, 0x51, 0x00, 0x44, 0x00, 0x11, 0x00, 0x40, 0x00, 0x11, 0x00, 0x04, 0x00,
    0x11, 0x00, 0x14, 0x00, 0x11, 0x20, 0x50, 0x00, 0x11, 0x00, 0x14, 0x00, 0x11, 0x02, 0x54, 0x00,
    0x11, 0x00, 0x05, 0x00, 0x15, 0x00, 0x55, 0x00, 0x15, 0x3b, 0x55, 0xae, 0x55, 0xfa, 0xf5, 0xef,
    0x75, 0x00, 0x14, 0x00, 0x50, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x01, 0x00, 0x01, 0x00, 0x01, 0x00, 0x10, 0x00, 0x01, 0x02, 0x00, 0x00, 0x01, 0x00, 0x05, 0x00,
    0x01, 0x00, 0x05, 0x00, 0x01, 0x00, 0x01, 0x00, 0x01, 0x00, 0x40, 0x00, 0x01, 0x00, 0x40, 0x00,
    0x01, 0x00, 0x40, 0x00, 0x01, 0x00, 0x54, 0x00, 0x11, 0x00, 0x00, 0x00, 0x11, 0x00, 0x00, 0x00,
    0x05, 0x00, 0x01, 0x00, 0x11, 0x00, 0x00, 0x00, 0x01, 0x00, 0x05, 0x00, 0x01, 0x00, 0x00, 0x00,
    0x01, 0x00, 0x04, 0x00, 0x01, 0x00, 0x00, 0x00, 0x11, 0x00, 0x04, 0x00, 0x11, 0x00, 0x40, 0x00,
    0x11, 0x00, 0x01, 0x00, 0x15, 0x00, 0x55, 0x80, 0x55, 0x02, 0x55, 0x0a, 0x55, 0xaf, 0x55, 0xbf,
    0x77, 0xfe, 0x54, 0x00, 0x11, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x04, 0x00, 0x14, 0x00, 0x00, 0x00,
    0x10, 0x00, 0x10, 0x00, 0x10, 0x00, 0x50, 0x00, 0x10, 0x00, 0x11, 0x00, 0x11, 0x00, 0x04, 0x00,
    0x11, 0x00, 0x04, 0x00, 0x01, 0x00, 0x04, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x14, 0x36, 0x15, 0x00, 0x54, 0x00,
    0x11, 0x00, 0x00, 0x00, 0x11, 0x00, 0x04, 0x00, 0x11, 0x02, 0x45, 0x00, 0x15, 0x00, 0x55, 0x00,
    0x15, 0x03, 0x05, 0x00, 0x15, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x04, 0x00,
    0x15, 0x08, 0x10, 0x00, 0x01, 0x00, 0x40, 0x00, 0x11, 0x00, 0x40, 0x00, 0x11, 0x00, 0x50, 0x00,
    0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

const uint8_t enemigo01[] PROGMEM={//16x8
    0x00, 0x20, 0xDC, 0xFE, 0x77, 0x3F, 0x1F, 0x3E, 0x31, 0x28, 0x44, 0x00, 0x40, 0x20, 0x10, 0x00,   // 0x0010 (16) pixels
};

const uint8_t enemigo02[] PROGMEM={//16*8
    0x00, 0x20, 0xdc, 0xfe, 0x77, 0x3f, 0x1f, 0x3e, 0x30, 0x20, 0x40, 0x80, 0x00, 0x80, 0x80, 0x00
};

const uint8_t player[] PROGMEM={//16x8
    0x11, 0x1F, 0x1E, 0x9E, 0x76, 0xFE, 0xDC, 0xFE, 0x77, 0x7F, 0x5A, 0x72, 0x60, 0xE0, 0x50, 0x70,   // 0x0010 (16) pixels
};

const uint8_t player2[] PROGMEM={//16x8
    0x50, 0x30, 0x51, 0x22, 0x71, 0x7E, 0x5C, 0xFE, 0x57, 0xFE, 0x5C, 0x9C, 0x54, 0x88, 0x50, 0x20,   // 0x0010 (16) pixels
};

const uint8_t tierra[] PROGMEM={//8*58
    0x54, 0xe8, 0x40, 0x80, 0x40, 0x00, 0x00, 0x00, 0x55, 0xee, 0x55, 0xab, 0x54, 0x88, 0x40, 0x00,
    0x55, 0xee, 0x55, 0xbf, 0x55, 0xee, 0x55, 0xf8, 0x55, 0xee, 0x55, 0xbf, 0x55, 0xee, 0x55, 0xff,
    0x55, 0xee, 0x55, 0xff, 0x55, 0xee, 0x55, 0xff, 0x55, 0xae, 0x55, 0xff, 0x55, 0xae, 0x55, 0x01,
    0x55, 0xee, 0x55, 0x0f, 0x05, 0x00, 0x00, 0x00
};

const uint8_t flecha[] PROGMEM={//8x8
    0x0, 0x0, 0x81, 0x81, 0xC3, 0xC3, 0x66, 0x0,
};

const uint8_t flecha2[] PROGMEM={//8x4
    0x06, 0x0c, 0x08, 0x00, 0x00, 0x08, 0x0c, 0x06
};

const uint8_t bala[] PROGMEM={//8x8
    0x10, 0x10, 0x14, 0x2e, 0x55, 0x38, 0x54, 0x28
};

const uint8_t corazon[] PROGMEM={//8X6
    0X00 ,0x0e, 0x1e, 0x3c, 0x2e, 0x17, 0x0e, 0X00
};

bool drawCollisionableBitmap(int,int,uint8_t*,int,int);//Dibuja un objeto y dice si colisiono

struct Sprite{//Se crea un dato de tipo sprite por cada jugador, enemigo, bala, etc que requiera moverse
    byte posx,posy;//Posicion del sprite
    byte posory;//Posicion de origen
    byte alto,ancho;//Tamaño de la imagen
    const uint8_t *imagen;
    const uint8_t *imagen2;
    byte type;//Tipo de sprite (Estan definidos arriba)
    void setType(byte t){
        type=t;
        switch(t){
            case ENEMIGO:
                imagen=enemigo01;
                imagen2=enemigo02;
                ancho=16;
                alto=8;
                break;
            case BALA:
                imagen=bala;
                ancho=8;
                alto=8;
                break;
            case PLAYER:
                imagen=player;
                ancho=16;
                alto=8;
        }
    }
    void setPosicion(byte px,byte py){
        posx=px;
        posy=posory=py;
    }
    bool draw(byte variante){//Dibuja el sprite
        if(variante==0)
            return drawCollisionableBitmap(posx,posy,(uint8_t*)imagen,ancho,alto);
        else
            return drawCollisionableBitmap(posx,posy,(uint8_t*)imagen2,ancho,alto);
    }
    bool draw(){
        return draw(0);
    }

    void drawRect(){
        myOLED.drawRect((int)posx,(int)posy,(int)posx+ancho,(int)posy+alto);
    }

    bool isNearOf(const Sprite &p){
        return p.posx>(int)posx-p.ancho && p.posx<(int)posx+p.ancho+ancho && p.posy>(int)posy-p.alto && p.posy<(int)posy+p.alto+alto;
    }

    bool operator >(const Sprite &p){
        return posx==p.posx?posy>p.posy:posx>p.posx;
    }
    bool operator <(const Sprite &p){
        return posx==p.posx?posy<p.posy:posx<p.posx;
    }
    bool operator +=(const byte v){
        posx+=v;
    }
    bool operator -=(const byte v){
        posx-=v;
        if(type==ENEMIGO){
            byte mod=32;
            posy=posory+(posx%mod>mod/2?map(posx%mod,mod-1,mod/2,0,8):map(posx%mod,mod/2,0,8,0));
        }
    }
};

int readJoystick(byte,int,int);//Convierte los valores del joystick a valores que se suman a las cordenadas
void barraDeCarga();//Muestra una barra de carga
void barraDeEstado(byte);
void draw();//actualiza los elementos en la pantalla
void moverplayer();//Cambia la posicion del jugador de acuerdo al joystick
void disparar();//Dispara y realiza el avance de las balas
void ordenarSpritesDesc(Sprite[],byte);//Ordena de forma desendente un arreglo de sprites
void ordenarSpritesAsc(Sprite[],byte);//Ordena de forma asendente un arreglo de sprites
void avanceEnemigo();//Crear y avanza enemigos
byte getColision(Sprite,Sprite[],byte);//busca el objeto con el que cooliciono


byte x[5],y[5],con=254;//Posicion de las estrellas(En desuso)
Sprite playerP;//Sprite del jugador
Sprite balas[MAXBALAS];//sprites de las balas
Sprite enemigos[MAXENEMIGOS];//sprites de los enemigos
byte nbalas=0;//numero de balas actualmente
byte nEnemigos=0;//numero de enemigos actualmente
byte recargabalas=0;//Controla que las balas se disparen cada determinado tiempo
byte genenemigos=0;//Controla que los enemigos se generen cada determinado tiempo

void setup()
{
    if(!myOLED.begin(SSD1306_128X64))
        while(1);   // En caso de que la libreria falle por falta de memoria se congela el programa
    myOLED.setBrightness(1);//Ajusta el brillo de la pantalla
    myOLED.rotateDisplay(false);//Cambia la orientacion de la pantalla Invertida/Normal
    //Dibuja la portada del juego en buffer
    myOLED.drawBitmap(0,0,(uint8_t*)portada,128,64);
    myOLED.update();
    //Se crea semilla aleatoria
    srandom(millis());
    //configura pines
    pinMode(EJEX,INPUT);
    pinMode(EJEY,INPUT);
    pinMode(BOTON,INPUT);
    delay(2000);//Espera 2 segundos
    //barraDeCarga();
    myOLED.setFont((uint8_t*)TinyFont);//cambia la fuente de texto
    //Inicializa el sprite del jugador
    playerP.posx=8;
    playerP.posy=28;
    playerP.setType(PLAYER);
}

void loop()
{
    draw();//Actualizar elementos de la pantalla
//    moverplayer();
//    bool c=drawCollisionableBitmap(64,32,(uint8_t*)enemigo01,16,8);
//    myOLED.printNumI(c,0,0);
//    myOLED.update();
//    myOLED.clrScr();
    //delay(500);
}

void draw(){
    myOLED.clrScr();//Limpiar pantalla
    disparar();//Avanzar disparos
    moverplayer();//Mover jugador
    avanceEnemigo();//Avanzar enemigos
    //myOLED.drawHLine(0,5,128);
    myOLED.drawBitmap(0,6,(uint8_t*)tierra,8,58);//dibujar tierra en el lado izquierdo
    barraDeEstado(3);
    myOLED.update();//Dibujar en pantalla
}

void moverplayer(){
    //Se escucha al joystick
    playerP.posx+=readJoystick(EJEX,5,0);
    playerP.posy-=readJoystick(EJEY,5,0);
    //Se controla que el jugador no se salga de la pantalla
    if(playerP.posx<8){
        playerP.posx=8;
    }else if(playerP.posx>127-16){
        playerP.posx=127-16;
    }
    if(playerP.posy>200||playerP.posy<6){
        playerP.posy=6;
    }else if(playerP.posy>63-8){
        playerP.posy=63-8;
    }
    playerP.draw();// Se dibuja al jugadro
}

int readJoystick(byte pin,int maxval,int deadzone){//pin= pin del joystick a leer, maxval=Maximo valor que tomara el joystick, deadzone=zona muerta(zona del medio donde el joystick no responde)
    int tem=analogRead(pin);//Se lee el pin del eje del joystick a convertir
    if(tem>443+deadzone){//Si el joystick se inclina hacia un lado en ese eje
        tem-=443+deadzone;
        tem*=maxval/(443.0-deadzone);
    }else if(tem<443-deadzone){//Si el joystick se inclina hacia el otro lado
        tem=maxval/(443.0-deadzone)*((443.0-deadzone)-tem);
        tem*=-1;
    }else{//Si el joystick no esta inclinado
        tem=0;
    }
    return tem;
}

void barraDeCarga(){
    uint8_t barra[]={0x7E};//fondo de la barra
    uint8_t fondoBarra[]={0x81};//relleno de la barra
    //se dibuja el fondo de la barra
    for(int i=0;i<128;i++){
        myOLED.drawBitmap(i,55,fondoBarra,1,8);
    }
    myOLED.update();
    //Se rellena la barra lentamente
    for(int i=0;i<128;i+=2){
        myOLED.drawBitmap(i,55,barra,1,8);
        myOLED.update();
        delay(20);
    }
}
void barraDeEstado(byte vida){
    for(int i=0;i<vida&&i<5;i++){
        myOLED.drawBitmap((i*8),0,(uint8_t*)corazon,8,6);
    }
    myOLED.print("LV:",28,0);
    myOLED.printNumI(1,40,0);
    myOLED.print("E:",48,0);
    myOLED.printNumI(nEnemigos,56,0);
    myOLED.print("B:",64,0);
    myOLED.printNumI(nbalas,72,0);
}
void disparar(){
    bool b=digitalRead(BOTON);//lee el boton del joystick(y el otro boton si lo tienen XD)
    //Se genera una bala si se presiona el boton, hay menos balas que el limite de balas y el tiempo de recarga es cero
    if(!b&&nbalas<MAXBALAS&&recargabalas==0){
        byte i=nbalas;//Se ubica en la posicion del arreglo donde se creara la proxima bala
        //Se inicializa bala delante del jugador
        balas[i].posx=playerP.posx+16;
        balas[i].posy=playerP.posy;
        balas[i].setType(BALA);
        nbalas++;//Se incrementa el numero de balas
        ordenarSpritesAsc(balas,nbalas);//Se ordenan las balas para su facil eliminacion
        recargabalas=RECARGA;//Se reinicia el tiempo para el proximo disparo
    }
    byte nb=nbalas;//variable temporal que contiene el numero de balas
    for(int i=nb;i>0;i--){//se recorren las balas una por una
        balas[i-1]+=VELBALAS;//Se avanza la bala
        if(balas[i-1].posx>127){//Si la bala esta fuera de la pantalla se elimina
            nbalas--;
        }else{//Sino se dibuja
            balas[i-1].draw();
        }
    }
    if(recargabalas>0){//Si aun falta para el proximo disparo se reduce el tiempo
        recargabalas--;
    }
}

//Ordena los sprites por su posicion en x de forma desendente mediante metodo de burbuja
void ordenarSpritesDesc(Sprite arr[],byte cont){//arr= arreglo de sprites a ordenar, cont= cantidad de sprites en el arreglo
    Sprite tem;
    for(int i=0;i<cont-1;i++){
        for(int j=0;j<cont-i-1;j++){
            if(arr[j]<arr[j+1]){
                tem=arr[j];
                arr[j]=arr[j+1];
                arr[j+1]=tem;
            }
        }
    }
}
//Ordena los sprites por su posicion en x de forma asendente mediante metodo de burbuja
void ordenarSpritesAsc(Sprite arr[],byte cont){//arr= arreglo de sprites a ordenar, cont= cantidad de sprites en el arreglo
    Sprite tem;
    for(int i=0;i<cont-1;i++){
        for(int j=0;j<cont-i-1;j++){
            if(arr[j]>arr[j+1]){
                tem=arr[j];
                arr[j]=arr[j+1];
                arr[j+1]=tem;
            }
        }
    }
}

void avanceEnemigo(){
    //Si no se ha superado el numero maximo de enemigos y el tiempo de generacion es cero se crea otro enemigo
    if(nEnemigos<MAXENEMIGOS && genenemigos==0){
        byte i=nEnemigos;//Se ubica en la posicion del arreglo donde se creara el proximo enemigo
        //Se genera el enemigo en una posicion aleatoria en el borde derecho
        enemigos[i].setPosicion(127,random(6,64-16));
        //enemigos[i].posy=random(6,64-16);
        //enemigos[i].posx=127;
        enemigos[i].setType(ENEMIGO);
        nEnemigos++;//Se incrementa el numero de enemigos
        genenemigos=SEPENEMIGOS;//Se reinicia el tiempo para generar el proximo enemigo
        ordenarSpritesDesc(enemigos,nEnemigos);//Se ordenan los enemigos para una facil eliminacion
    }
    for(int i=nEnemigos;i>0;i--){//Se recorren todos los enemigos
        enemigos[i-1]-=VELENEMIGOS;//Se avanza el enemigo
        if(enemigos[i-1].posx>200&&enemigos[i-1].posx<255){//Si el enemigo se sale de la pantalla se elimina
            nEnemigos--;
        }else{//Sino se dibuja
            int xi=enemigos[i-1].posx;
            //int yi=enemigos[i-1].posy;
            //byte mod=32;
            //int yi=enemigos[i-1].posy+(xi%mod>mod/2?map(xi%mod,mod-1,mod/2,0,8):map(xi%mod,mod/2,0,8,0));
            //enemigos[i-1]-=VELENEMIGOS;
            bool colision=enemigos[i-1].draw(xi%4>1);
            if(colision){
                //myOLED.drawRect(xi,yi,xi+16,yi+8);
                enemigos[i-1].drawRect();
                byte temcolicion=getColision(enemigos[i-1],balas,nbalas);
                if(temcolicion!=-1)
                    balas[temcolicion].drawRect();
                else if(playerP.isNearOf(enemigos[i-1]))
                    playerP.drawRect();
            }
            //enemigos[i-1].draw();
        }
    }
    //Si queda tiempo para la generacion dek proximo enemigo se reduce
    if(genenemigos>0){
        genenemigos--;
    }
}

bool drawCollisionableBitmap(int x, int y, uint8_t* bitmap, int sx, int sy){
    bool colision=false;
	int bit;
	byte data;
    uint16_t by, bi;
	for (int cy=0; cy<sy; cy++){
		bit= cy % 8;
		for(int cx=0; cx<sx; cx++){
			data=bitmapbyte(cx+((cy/8)*sx));
			if ((data & (1<<bit))>0){
                colision=myOLED.getPixel(x+cx, y+cy)||colision;
			}else{
				//myOLED.clrPixel(x+cx, y+cy);
            }
		}
	}
	return colision;
}

byte getColision(Sprite spr,Sprite arr[],byte cant){
    int i=0;
    for(;i<cant;i++){
        if(spr.isNearOf(arr[i]))
            return i;
    }
    return -1;
}

